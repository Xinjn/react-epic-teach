{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Dragger","Upload","Result","styled","div","H1","h1","Image","img","Compenent","observer","useStores","ImageStore","UserStore","ref1","useRef","ref2","store","useLocalStore","width","setWidth","height","setHeight","serverFile","attributes","url","widthStr","heightStr","props","showUploadList","beforeUpload","file","setFile","setFilename","name","currentUser","message","warning","window","test","type","size","error","upload","then","console","log","catch","tip","spinning","isUpLoading","className","InboxOutlined","target","href","filename","src","ref","onChange","current","value","placeholder","fullStr","Tips","Component","children","Home","Uploader"],"mappings":"iPAOQA,EAAYC,IAAZD,QAEFE,EAASC,IAAOC,IAAV,kGAMNC,EAAKF,IAAOG,GAAV,uEAKFC,EAAQJ,IAAOK,IAAV,kDAqHIC,EAjHGC,aAAS,WAAO,IAAD,EACKC,cAA1BC,EADqB,EACrBA,WAAYC,EADS,EACTA,UACdC,EAAOC,mBACPC,EAAOD,mBAEPE,EAAQC,aAAc,iBAAO,CAC/BC,MAAO,KACPC,SAF+B,SAEtBD,GACLF,EAAME,MAAQA,GAElB,eACI,OAAOF,EAAME,MAAN,aAAkBF,EAAME,OAAQ,IAE3CE,OAAQ,KACRC,UAT+B,SASrBD,GACNJ,EAAMI,OAASA,GAEnB,gBACI,OAAOJ,EAAMI,OAAN,aAAmBJ,EAAMI,QAAS,IAE7C,cAEI,OAAOT,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,IAAI,gBAAgBR,EAAMS,SAAST,EAAMU,eAgBlGC,EAAQ,CACVC,gBAAe,EACfC,aAAc,SAAAC,GAIV,OAFAnB,EAAWoB,QAAQD,GACnBnB,EAAWqB,YAAYF,EAAKG,MACE,OAA1BrB,EAAUsB,aACVC,IAAQC,QAAQ,+CACT,IAEXC,OAAOP,KAAOA,EACT,wCAAwCQ,KAAKR,EAAKS,MAInDT,EAAKU,KAAO,SACZL,IAAQM,MAAM,+BACP,IAEX9B,EAAW+B,SACNC,MAAK,SAACrB,GACHsB,QAAQC,IAAI,4BACZD,QAAQC,IAAIvB,MACbwB,OAAM,WACLF,QAAQC,IAAI,gCAEb,IAdHV,IAAQM,MAAM,0EACP,MAiBnB,OACI,gCACI,cAAC,IAAD,CAAMM,IAAI,qBAAMC,SAAUrC,EAAWsC,YAArC,SACI,eAAClD,EAAD,2BAAa4B,GAAb,cACI,mBAAGuB,UAAU,uBAAb,SACA,cAACC,EAAA,EAAD,MAEA,mBAAGD,UAAU,kBAAb,0EACA,mBAAGA,UAAU,kBAAb,uHAOAvC,EAAWW,WAAa,eAACrB,EAAD,WACpB,cAACG,EAAD,uCACA,+BACI,2DACA,6BACI,mBAAGgD,OAAO,SAASC,KAAM1C,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,IAAzE,SACKb,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,QAGzD,oDACA,6BAAKb,EAAW2C,WAChB,0DACA,6BACI,cAAChD,EAAD,CAAOiD,IAAK5C,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,QAEhE,0DACA,+BACI,uBAAOgC,IAAK3C,EAAM4C,SA1EtB,WACpBb,QAAQC,IAAI,mBACZD,QAAQC,IAAIhC,EAAK6C,QAAQC,OACzB3C,EAAMG,SAASN,EAAK6C,QAAQC,QAuEyCC,YAAY,qDACzD,uBAAOJ,IAAKzC,EAAO0C,SArEtB,WACrBb,QAAQC,IAAI,oBACZD,QAAQC,IAAI9B,EAAK2C,QAAQC,OACzB3C,EAAMK,UAAUN,EAAK2C,QAAQC,QAkE0CC,YAAY,wDAE/D,6BACI,mBAAGR,OAAO,SAASC,KAAMrC,EAAM6C,QAA/B,SAAyC7C,EAAM6C,kBAG/C,WC9H1BC,EAAO5D,IAAOC,IAAV,oIAoBK4D,EAZGtD,aAAS,YAAmB,IAAhBuD,EAAe,EAAfA,SAClBpD,EAAcF,cAAdE,UAER,OADAgC,QAAQC,IAAIjC,GAER,mCAEQA,EAAUsB,YAAc,KAAO,cAAC4B,EAAD,UAAOE,SCdhDC,EAAOxD,aAAS,WAElB,OACI,qCAEQ,cAAC,EAAD,2EAIJ,cAACyD,EAAD,UAKGD","file":"static/js/9.8adfd964.chunk.js","sourcesContent":["import React,{useRef} from 'react';\r\nimport { useStores } from './../stores/index';\r\nimport { observer, useLocalStore} from 'mobx-react'\r\nimport { message, Upload,Spin} from 'antd';\r\nimport { InboxOutlined } from '@ant-design/icons';\r\nimport styled from 'styled-components';\r\n\r\nconst { Dragger } = Upload;\r\n\r\nconst Result = styled.div`\r\n    margin-top:30px;\r\n    border:1px dashed #ccc;\r\n    padding:20px;\r\n`\r\n\r\nconst H1 = styled.h1`\r\n    margin:20px 0;\r\n    text-align:center\r\n`\r\n\r\nconst Image = styled.img`\r\n    max-width:300px;\r\n`\r\n\r\nconst Compenent = observer(() => {\r\n    const { ImageStore, UserStore } = useStores()\r\n    const ref1 = useRef()\r\n    const ref2 = useRef()\r\n\r\n    const store = useLocalStore(() => ({\r\n        width: null,\r\n        setWidth(width) {\r\n            store.width = width\r\n        },\r\n        get widthStr() {\r\n            return store.width?`/w/${store.width}`:\"\"\r\n        },\r\n        height: null,\r\n        setHeight(height) {\r\n            store.height = height\r\n        },\r\n        get heightStr() {\r\n            return store.height?`/h/${store.height}`:\"\"\r\n        },\r\n        get fullStr() {\r\n            //?imageView2/0/w/800/h/400\r\n            return ImageStore.serverFile.attributes.url.attributes.url+'?imageView2/0'+store.widthStr+store.heightStr\r\n        }\r\n    }))\r\n\r\n    const bindWidthChange = () => {\r\n        console.log('bindWidthChange');\r\n        console.log(ref1.current.value);\r\n        store.setWidth(ref1.current.value)\r\n    }\r\n\r\n    const bindHeightChange = () => {\r\n        console.log('bindHeightChange');\r\n        console.log(ref2.current.value);\r\n        store.setHeight(ref2.current.value)\r\n    }\r\n\r\n    const props = {\r\n        showUploadList:false,\r\n        beforeUpload: file => {\r\n            // console.log(file);\r\n            ImageStore.setFile(file)\r\n            ImageStore.setFilename(file.name)\r\n            if (UserStore.currentUser === null) {\r\n                message.warning('请先登录再上传')\r\n                return false\r\n            }\r\n            window.file = file\r\n            if (!/(svg$)|(png$)|(jpg$)|(jpeg$)|(git$)/ig.test(file.type)) {\r\n                message.error('只能上传png/svg/jpg/gif格式的图片')\r\n                return false\r\n            }\r\n            if (file.size > 1024 * 1024) {\r\n                message.error('图片最大1M')\r\n                return false\r\n            }\r\n            ImageStore.upload()\r\n                .then((serverFile) => {\r\n                    console.log('上传成功');\r\n                    console.log(serverFile);\r\n                }).catch(() => {\r\n                    console.log('上传失败');\r\n            })\r\n            return false\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <Spin tip=\"上传中\" spinning={ImageStore.isUpLoading}>\r\n                <Dragger {...props}>\r\n                    <p className=\"ant-upload-drag-icon\">\r\n                    <InboxOutlined />\r\n                    </p>\r\n                    <p className=\"ant-upload-text\">点击或者拖拽上传图片</p>\r\n                    <p className=\"ant-upload-hint\">\r\n                    仅支持.png/.gif/.jpg/.svg格式的图片，图片最大1M\r\n                    </p>\r\n                </Dragger>\r\n            </Spin>\r\n          \r\n                {\r\n                    ImageStore.serverFile ? <Result>\r\n                        <H1>上传结果</H1>\r\n                        <dl>\r\n                            <dt> 线上地址</dt>\r\n                            <dd>\r\n                                <a target=\"_blank\" href={ImageStore.serverFile.attributes.url.attributes.url}> \r\n                                    {ImageStore.serverFile.attributes.url.attributes.url}\r\n                                </a>\r\n                            </dd>\r\n                            <dt>文件名</dt>\r\n                            <dd>{ImageStore.filename}</dd>\r\n                            <dt>图片预览</dt>\r\n                            <dd>\r\n                                <Image src={ImageStore.serverFile.attributes.url.attributes.url} />\r\n                            </dd>\r\n                            <dt>更多尺寸</dt>\r\n                            <dd>\r\n                                <input ref={ref1} onChange={bindWidthChange} placeholder=\"最大宽度（可选）\" />\r\n                                <input ref={ref2}  onChange={bindHeightChange} placeholder=\"最大高度（可选）\" />\r\n                            </dd>\r\n                            <dd>\r\n                                <a target=\"_blank\" href={store.fullStr}>{store.fullStr}</a>\r\n                            </dd>\r\n                        </dl>\r\n                    </Result> : null\r\n                }\r\n        </div>\r\n    )\r\n})\r\n\r\nexport default Compenent","import React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { useStores } from '../stores';\r\nimport styled from 'styled-components';\r\n\r\nconst Tips = styled.div`\r\n    background:orange;\r\n    padding:10px;\r\n    margin:30px 0;\r\n    color:#fff;\r\n    border-radius:4px;\r\n`\r\n\r\nconst Component = observer(({ children }) => {\r\n    const { UserStore } = useStores()\r\n    console.log(UserStore);\r\n    return (\r\n        <>\r\n            {\r\n                UserStore.currentUser ? null : <Tips>{children}</Tips>\r\n            }\r\n        </>\r\n    )\r\n})\r\n\r\nexport default Component","import React from 'react'\r\nimport { observer } from 'mobx-react';\r\nimport Uploader from '../components/Uploader'\r\nimport Tips from '../components/Tips'\r\n\r\nconst Home = observer(() => {\r\n    \r\n    return (\r\n        <>\r\n            {\r\n                <Tips>请先登录再上传！！！</Tips>\r\n\r\n            }\r\n            \r\n            <Uploader/>\r\n        </>\r\n    )\r\n})\r\n\r\nexport default Home"],"sourceRoot":""}